
--ZADATAK 1 Pronaci ime glumca koji je igrao Vronskog u filmu sa naslovom Anna Karenina.
SELECT GLUMAC.IME, GLUMAC.PREZIME
FROM GLUMAC, IGRA, FILM
WHERE GLUMAC.BROJ = IGRA.GLUMAC AND IGRA.FILM = FILM.BROJ
      AND FILM.NASLOV = 'Anna Karenina' AND IGRA.ULOGA = 'Vronsky';
      
--ZADATAK 2 Prikazati tipove filmova za koje postoji vi�e od 5 filmova u bazi podataka. Sortirati prikaz po broju filmova u opadajucem redosledu.
SELECT TIP, COUNT(*) AS BROJ_FILMOVA
FROM FILM
GROUP BY TIP
HAVING COUNT(*) > 5
ORDER BY BROJ_FILMOVA DESC;

--ZADATAK 3 Pronaci brojeve i naslove filmova u kojima glumi glumac Slavko �timac ili ih je re�irao reditelj Srdjan Karanovic.
SELECT FILM.BROJ, FILM.NASLOV 
FROM FILM INNER JOIN REZISER ON FILM.REZISER = REZISER.BROJ
WHERE IME = 'Srdjan' AND PREZIME = 'Karanovic'
UNION
SELECT FILM.BROJ, FILM.NASLOV 
FROM FILM INNER JOIN IGRA ON FILM.BROJ = IGRA.FILM
     INNER JOIN GLUMAC ON IGRA.GLUMAC = GLUMAC.BROJ
WHERE GLUMAC.IME = 'Slavko' AND GLUMAC.PREZIME = 'Stimac';

--ZADATAK 4 Pronaci brojeve i naslove filmova koje je re�irao Emir Kusturica i u kojima glumi Slavko �timac.
SELECT FILM.BROJ, FILM.NASLOV
FROM FILM INNER JOIN REZISER ON FILM.REZISER = REZISER.BROJ
WHERE REZISER.IME = 'Emir' AND REZISER.PREZIME = 'Kusturica'
INTERSECT
SELECT FILM.BROJ, FILM.NASLOV
FROM FILM INNER JOIN IGRA ON FILM.BROJ = IGRA.FILM
          INNER JOIN GLUMAC ON IGRA.GLUMAC = GLUMAC.BROJ
WHERE GLUMAC.IME = 'Slavko' AND GLUMAC.PREZIME = 'Stimac'; 

--alternativno resenje
SELECT FILM.BROJ, FILM.NASLOV
FROM FILM INNER JOIN REZISER ON FILM.REZISER = REZISER.BROJ
          INNER JOIN IGRA ON FILM.BROJ = IGRA.FILM
          INNER JOIN GLUMAC ON IGRA.GLUMAC = GLUMAC.BROJ
WHERE REZISER.IME = 'Emir' AND REZISER.PREZIME = 'Kusturica'
      AND GLUMAC.IME = 'Slavko' AND GLUMAC.PREZIME = 'Stimac'; 
      

--ZADATAK 5 Prikazati podatke o re�iserima koji su re�irali i komedije i drame.
SELECT DISTINCT REZISER.BROJ, REZISER.IME, REZISER.PREZIME 
FROM REZISER, FILM
WHERE REZISER.BROJ = FILM.REZISER
      AND FILM.TIP = 'drama'
INTERSECT 
SELECT DISTINCT REZISER.BROJ, REZISER.IME, REZISER.PREZIME 
FROM REZISER, FILM
WHERE REZISER.BROJ = FILM.REZISER
      AND FILM.TIP = 'comedy';
      
--alternativno resenje      
SELECT REZISER.BROJ, REZISER.IME, REZISER.PREZIME 
FROM REZISER
WHERE REZISER.BROJ IN (SELECT REZISER FROM FILM WHERE TIP = 'drama')
      AND REZISER.BROJ IN (SELECT REZISER FROM FILM WHERE TIP = 'comedy');
      
--alternativno resenje
SELECT REZISER.BROJ, REZISER.IME, REZISER.PREZIME 
FROM REZISER
WHERE EXISTS (SELECT 0 FROM FILM WHERE REZISER = REZISER.BROJ AND TIP = 'drama')
      AND EXISTS (SELECT 0 FROM FILM WHERE REZISER = REZISER.BROJ AND TIP = 'comedy');
      
--ako trazimo samo rezisere koji su snimali drame ili komedije
SELECT REZISER.BROJ, REZISER.IME, REZISER.PREZIME 
FROM REZISER
WHERE EXISTS (SELECT 0 FROM FILM WHERE REZISER = REZISER.BROJ AND (TIP = 'drama' OR TIP = 'comedy'));


--ZADATAK 6 Pronaci broj i naslov filma koji nikada nije bio iznajmljen.
SELECT FILM.BROJ, FILM.NASLOV
FROM FILM
WHERE FILM.BROJ NOT IN (SELECT FILM FROM IZNAJMLJIVANJE);

--alternativno resenje
SELECT FILM.BROJ, FILM.NASLOV
FROM FILM
WHERE NOT EXISTS (SELECT 0 FROM IZNAJMLJIVANJE WHERE IZNAJMLJIVANJE.FILM = FILM.BROJ);

--alternativno resenje
SELECT FILM.BROJ, FILM.NASLOV
FROM FILM
WHERE (SELECT COUNT(*) FROM IZNAJMLJIVANJE WHERE IZNAJMLJIVANJE.FILM = FILM.BROJ) = 0;

--alternativno resenje
SELECT FILM.BROJ, FILM.NASLOV
FROM FILM LEFT JOIN IZNAJMLJIVANJE ON FILM.BROJ = IZNAJMLJIVANJE.FILM
WHERE IZNAJMLJIVANJE.BROJ IS NULL;

--alternativno resenje
SELECT FILM.BROJ, FILM.NASLOV
FROM FILM
MINUS
SELECT FILM.BROJ, FILM.NASLOV
FROM FILM INNER JOIN IZNAJMLJIVANJE ON FILM.BROJ = IZNAJMLJIVANJE.FILM;


--ZADATAK 7 Pronaci imena svih re�isera koji su re�irali isti broj filmova kao re�iser sa brojem 15.
SELECT REZISER.BROJ, REZISER.IME, REZISER.PREZIME, COUNT(*) BROJ_FILMOVA
FROM REZISER INNER JOIN FILM ON REZISER.BROJ = FILM.REZISER
     --AND FILM.REZISER <> 15 --alternativno iskljucimo rezisera ciji je broj 15
GROUP BY REZISER.BROJ, REZISER.IME, REZISER.PREZIME
HAVING COUNT(*) = (SELECT COUNT(*) FROM FILM WHERE REZISER = 15);


--alternativno resenje ako ne znamo broj vec ime rezisera
SELECT REZISER.BROJ, REZISER.IME, REZISER.PREZIME, COUNT(*) BROJ_FILMOVA
FROM REZISER INNER JOIN FILM ON REZISER.BROJ = FILM.REZISER
--WHERE REZISER.IME <> 'Claude' AND REZISER.PREZIME <> 'Chabrol' --alternativno ako zelimo da elimisemo i tog rezisera
GROUP BY REZISER.BROJ, REZISER.IME, REZISER.PREZIME
HAVING COUNT(*) = (SELECT COUNT(*) FROM FILM INNER JOIN REZISER ON FILM.REZISER = REZISER.BROJ
                   WHERE IME = 'Claude' AND PREZIME = 'Chabrol');
                   
                   
--ZADATAK 8 Pronaci re�isera koji je re�irao najvi�e drama.
SELECT REZISER.BROJ, REZISER.IME, REZISER.PREZIME, COUNT(*) BROJ_FILMOVA
FROM REZISER INNER JOIN FILM ON REZISER.BROJ = FILM.REZISER
WHERE FILM.TIP = 'drama'
GROUP BY REZISER.BROJ, REZISER.IME, REZISER.PREZIME
ORDER BY BROJ_FILMOVA DESC;

--alternativno resenje
SELECT * FROM (SELECT REZISER.BROJ, REZISER.IME, REZISER.PREZIME, COUNT(*) BROJ_FILMOVA
               FROM REZISER INNER JOIN FILM ON REZISER.BROJ = FILM.REZISER
               WHERE FILM.TIP = 'drama'
               GROUP BY REZISER.BROJ, REZISER.IME, REZISER.PREZIME
               ORDER BY BROJ_FILMOVA DESC)
WHERE ROWNUM = 1;

--alternativno resenje
SELECT REZISER.BROJ, REZISER.IME, REZISER.PREZIME, COUNT(*) BROJ_FILMOVA
FROM REZISER INNER JOIN FILM ON REZISER.BROJ = FILM.REZISER
WHERE FILM.TIP = 'drama'
GROUP BY REZISER.BROJ, REZISER.IME, REZISER.PREZIME
HAVING COUNT(*) = (SELECT MAX(COUNT(*)) FROM FILM WHERE TIP = 'drama' GROUP BY REZISER);
